{"ast":null,"code":"import _slicedToArray from\"/Users/rishisheth/Desktop/aws-amplify-ecommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: MIT-0\nimport React,{useState,useEffect,useContext}from'react';import{Grid}from'semantic-ui-react';import{Analytics}from'aws-amplify';import AppContext from'../context/AppContext';import InitState from'./InitState';import CheckoutBanner from'../components/CheckoutBanner';import CheckoutSummary from'../components/CheckoutSummary';import CheckoutPayment from'../components/CheckoutPayment';// var product_data = require('../products.json');\n// const uuidv4 = require('uuid/v4');\nfunction Checkout(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),ordering=_useState2[0],setOrdering=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),card=_useState4[0],setCard=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalPurchase=_useState6[0],setTotal=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),orderComplete=_useState8[0],setOrderComplete=_useState8[1];var _useContext=useContext(AppContext),user=_useContext.user,cart=_useContext.cart,items=_useContext.items,clearCart=_useContext.clearCart;var quantText=cart.items.length===1?'1 item':cart.items.length+' items';function handleCardUpdate(e){setCard(e.value);}function submitOrder(){setOrderComplete(true);}useEffect(function(){function calculateTotal(){var total=0;var _item=null;cart.items.map(function(item){var _product=items.filter(function(el){return el.id===item.id;});_product.length===1?_item=_product[0]:_item=null;total+=_item.price*item.quantity;return null;});setTotal(parseFloat(total).toFixed(2));return parseFloat(total).toFixed(2);}calculateTotal();},[cart.items,items]);useEffect(function(){if(orderComplete){Analytics.updateEndpoint({attributes:{hasShoppingCart:['false'],completedOrder:['true']},metrics:{itemsInCart:0,orderNumber:\"1001\"}});console.log(\"Purchase price\",totalPurchase);var _mTotal=parseFloat(totalPurchase).toFixed(2);Analytics.record('_monetization.purchase',{_currency:'USD',_product_id:'XYZ'},{_item_price:_mTotal,_quantity:1.0});clearCart();props.history.push('/');}},[orderComplete,props.history,clearCart,totalPurchase]);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(InitState,null),/*#__PURE__*/React.createElement(CheckoutBanner,{quantity:quantText}),/*#__PURE__*/React.createElement(\"div\",{style:mainDiv},/*#__PURE__*/React.createElement(Grid,{columns:2},/*#__PURE__*/React.createElement(Grid.Row,null,/*#__PURE__*/React.createElement(Grid.Column,{floated:\"left\",width:11},/*#__PURE__*/React.createElement(CheckoutSummary,{placedOrder:ordering,onCardUpdate:handleCardUpdate,onOrder:submitOrder,user:user,cart:cart,total:totalPurchase})),/*#__PURE__*/React.createElement(Grid.Column,{floated:\"right\",width:5},/*#__PURE__*/React.createElement(CheckoutPayment,{placedOrder:ordering,onOrder:submitOrder,user:user,cart:cart,total:totalPurchase}))))));}export default Checkout;var mainDiv={marginLeft:'5em',marginRight:'1em',marginTop:'2em'};","map":{"version":3,"sources":["/Users/rishisheth/Desktop/aws-amplify-ecommerce/src/pages/Checkout.js"],"names":["React","useState","useEffect","useContext","Grid","Analytics","AppContext","InitState","CheckoutBanner","CheckoutSummary","CheckoutPayment","Checkout","props","ordering","setOrdering","card","setCard","totalPurchase","setTotal","orderComplete","setOrderComplete","user","cart","items","clearCart","quantText","length","handleCardUpdate","e","value","submitOrder","calculateTotal","total","_item","map","item","_product","filter","el","id","price","quantity","parseFloat","toFixed","updateEndpoint","attributes","hasShoppingCart","completedOrder","metrics","itemsInCart","orderNumber","console","log","_mTotal","record","_currency","_product_id","_item_price","_quantity","history","push","mainDiv","marginLeft","marginRight","marginTop"],"mappings":"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","sourcesContent":["// Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: MIT-0\n\nimport React, {useState, useEffect, useContext} from 'react'\nimport { Grid } from 'semantic-ui-react'\nimport {Analytics} from 'aws-amplify';\n\nimport AppContext from '../context/AppContext'\n\nimport InitState from './InitState'\nimport CheckoutBanner from '../components/CheckoutBanner'\nimport CheckoutSummary from '../components/CheckoutSummary'\nimport CheckoutPayment from '../components/CheckoutPayment'\n\n// var product_data = require('../products.json');\n// const uuidv4 = require('uuid/v4');\n\nfunction Checkout(props) {\n    const [ordering, setOrdering] = useState(false)\n    const [card, setCard] = useState(0)\n    const [totalPurchase, setTotal] = useState(0)\n    const [orderComplete, setOrderComplete] = useState(false)\n\n    var {user, cart, items, clearCart} = useContext(AppContext)\n\n    const quantText = (cart.items.length === 1) ? '1 item' : cart.items.length + ' items'\n\n    function handleCardUpdate(e) {\n        setCard(e.value)\n    }\n\n    function submitOrder() {\n        setOrderComplete(true)\n    }\n\n    useEffect(() => {\n        function calculateTotal() {\n            var total = 0\n            var _item = null\n    \n            cart.items.map((item) => {\n                var _product = items.filter(function (el) {\n                    return el.id === item.id\n                })\n    \n                _product.length === 1 ? _item = _product[0] : _item = null\n                total += (_item.price * item.quantity)\n                return null\n            })\n    \n            setTotal(parseFloat(total).toFixed(2))\n            return parseFloat(total).toFixed(2)\n        }\n\n        calculateTotal()\n    }, [cart.items, items])\n\n    useEffect(() => {\n        if (orderComplete) {\n            Analytics.updateEndpoint({\n                attributes: {\n                    hasShoppingCart: ['false'],\n                    completedOrder: ['true']\n                },\n                metrics: {\n                    itemsInCart: 0,\n                    orderNumber: \"1001\"\n                }\n            })\n\n            console.log(\"Purchase price\", totalPurchase)\n\n            var _mTotal = parseFloat(totalPurchase).toFixed(2)\n            Analytics.record('_monetization.purchase', {\n                _currency: 'USD',\n                _product_id: 'XYZ',\n              }, {\n                _item_price: _mTotal,\n                _quantity: 1.0,\n              })\n\n            clearCart()\n\n            props.history.push('/')\n        }\n    }, [orderComplete, props.history, clearCart, totalPurchase]);\n\n    return (\n        <div>\n            <InitState/>\n            <CheckoutBanner quantity={quantText}/>\n            <div style={mainDiv}>\n                <Grid columns={2}>\n                    <Grid.Row>\n                    <Grid.Column floated='left' width={11}>\n                        <CheckoutSummary placedOrder={ordering} \n                                         onCardUpdate={handleCardUpdate} \n                                         onOrder={submitOrder}\n                                         user={user}\n                                         cart={cart}\n                                         total={totalPurchase}\n                                         />\n                    </Grid.Column>\n                    <Grid.Column floated='right' width={5}>\n                        <CheckoutPayment placedOrder={ordering} \n                                         onOrder={submitOrder}\n                                         user={user}\n                                         cart={cart}\n                                         total={totalPurchase}\n                                         />\n                    </Grid.Column>\n                    </Grid.Row>\n                </Grid>\n            </div>\n        </div>\n    )\n}\n\nexport default Checkout\n\nconst mainDiv = {\n    marginLeft: '5em',\n    marginRight: '1em',\n    marginTop: '2em'\n}"]},"metadata":{},"sourceType":"module"}